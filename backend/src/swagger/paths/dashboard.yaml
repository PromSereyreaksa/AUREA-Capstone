paths:
  /api/v1/dashboard:
    get:
      summary: Get dashboard overview
      description: >
        Returns the authenticated user's base hourly rate, project counts for
        the last 7 and 30 days, and the 5 most recently created projects.

        **Base rate resolution:**
        - Primary source: `base_hourly_rate` from `pricing_profiles`
        - Fallback: `base_rate_result` from the legacy `base_price` table
        - Returns `null` when neither source has a value

        **Recent projects** are ordered by `created_at DESC` and capped at 5.
      tags:
        - Dashboard
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Dashboard data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Dashboard data retrieved successfully
                  data:
                    $ref: "#/components/schemas/DashboardData"
              example:
                success: true
                message: Dashboard data retrieved successfully
                data:
                  base_rate: 28.50
                  projects_this_week: 2
                  projects_this_month: 7
                  recent_projects:
                    - project_id: 42
                      project_name: "Brand Identity Package"
                      title: "Logo + Guidelines"
                      created_at: "2026-02-24T10:30:00.000Z"
                    - project_id: 41
                      project_name: "Website Redesign"
                      title: null
                      created_at: "2026-02-22T08:00:00.000Z"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

components:
  schemas:
    DashboardData:
      type: object
      properties:
        base_rate:
          type: number
          format: float
          nullable: true
          description: >
            User's base hourly rate in USD. Sourced from pricing_profiles.base_hourly_rate;
            falls back to base_price.base_rate_result if not set. Null when neither exists.
          example: 28.50
        projects_this_week:
          type: integer
          description: Total number of projects created in the last 7 days.
          example: 2
        projects_this_month:
          type: integer
          description: Total number of projects created in the last 30 days.
          example: 7
        recent_projects:
          type: array
          description: Up to 5 most recently created projects, ordered by created_at DESC.
          maxItems: 5
          items:
            $ref: "#/components/schemas/RecentProject"

    RecentProject:
      type: object
      properties:
        project_id:
          type: integer
          description: Unique identifier for the project.
          example: 42
        project_name:
          type: string
          description: Name of the project.
          example: "Brand Identity Package"
        title:
          type: string
          nullable: true
          description: Optional subtitle / short description of the project.
          example: "Logo + Brand Guidelines"
        created_at:
          type: string
          format: date-time
          description: ISO 8601 timestamp of when the project was created.
          example: "2026-02-24T10:30:00.000Z"
